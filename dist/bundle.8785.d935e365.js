"use strict";(self.webpackChunkt_zero_user_operation_frontend=self.webpackChunkt_zero_user_operation_frontend||[]).push([[8785],{98785:(e,n,t)=>{t.r(n),t.d(n,{default:()=>j}),t(27793);var a=t(60331),r=(t(98264),t(27049)),l=(t(54337),t(4914)),s=(t(4456),t(49531)),i=(t(11125),t(92e3)),o=(t(45654),t(39144)),c=t(87462),d=(t(24713),t(82482)),u=(t(58645),t(71577)),m=t(15861),p=(t(95352),t(37614)),f=(t(47610),t(55026)),h=t(15671),b=t(43144),_=t(97326),g=t(79340),Z=t(82963),y=t(61120),k=t(4942),v=(t(10534),t(20924)),x=(t(21384),t(16317)),E=t(87757),I=t.n(E),C=t(67294),w=t(55609),F=t(93379),M=t.n(F),S=t(18476);M()(S.Z,{insert:"head",singleton:!1});const D=S.Z.locals||{};var V=t(47166),U=t.n(V),O=t(5582),P=t.n(O),L=t(29439);const N=function(e){var n=e.visible,t=e.submitMap,a=e.onCancel,r=(e.currentDetailData,d.Z.useForm()),l=(0,L.Z)(r,1)[0];return C.createElement(p.Z,{visible:n,title:"新建用户",onCancel:function(){l.resetFields(),a()},destroyOnClose:!0,onOk:function(){l.validateFields().then((function(e){l.resetFields(),l.setFieldsValue(e),t(e)})).catch((function(e){console.log("校验失败:",e)}))}},C.createElement(d.Z,(0,c.Z)({form:l},{labelCol:{span:5},wrapperCol:{span:18}},{name:"createUser",initialValues:{gender:0}}),C.createElement(d.Z.Item,{label:"账号",name:"username",rules:[{required:!0,message:"请输入账号",whitespace:!0}],hasFeedback:!0},C.createElement(v.Z,{placeholder:"请输入姓名称"})),C.createElement(d.Z.Item,{label:"姓名",name:"nickName",rules:[{required:!0,message:"请输入姓名",whitespace:!0}],hasFeedback:!0},C.createElement(v.Z,{placeholder:"请输入姓名"})),C.createElement(d.Z.Item,{label:"手机号",name:"phoneNumber",validateStatus:"warning",rules:[{required:!0,message:"请输入手机号"}],hasFeedback:!0},C.createElement(v.Z,{placeholder:"请输入手机号"})),C.createElement(d.Z.Item,{label:"邮箱",name:"emailAddress",validateStatus:"warning",rules:[{type:"email",message:"这不是个正确的邮箱"},{required:!1,message:"请确认邮箱"}],hasFeedback:!0},C.createElement(v.Z,{placeholder:"请确认邮箱"})),C.createElement(d.Z.Item,{label:"备注",name:"remark"},C.createElement(v.Z,{placeholder:"请输入备注"}))))};var T;function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach((function(n){(0,k.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var z=U().bind(D),A=(x.Z.Option,v.Z.TextArea),j=(0,w.connect)((function(e){return{global:e.global,userManage:e.userManage}}))(T=function(e){(0,g.Z)(E,e);var n,t,x=(n=E,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,y.Z)(n);if(t){var r=(0,y.Z)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return(0,Z.Z)(this,e)});function E(e){var n;return(0,h.Z)(this,E),n=x.call(this,e),(0,k.Z)((0,_.Z)(n),"searchFormRef",C.createRef()),(0,k.Z)((0,_.Z)(n),"userFormRef",C.createRef()),(0,k.Z)((0,_.Z)(n),"onReset",(function(){n.searchFormRef.current.resetFields(),n.searchUserists()})),(0,k.Z)((0,_.Z)(n),"searchUserists",(function(e){var t=n.props.dispatch,a=n.state.dataSource;t({type:"userManage/getUserLists",opt:q({currentPage:null!=e&&e.phoneNumber?1:a.currentPage||1,pageSize:a.pageSize},n.searchFormRef.current.getFieldValue()),callback:function(e){var t,a=null==e||null===(t=e.data)||void 0===t?void 0:t.data;n.setState({dataSource:{dataList:a.list,total:a.totalCount,currentPage:a.currentPage,pageSize:a.pageSize}})}})})),(0,k.Z)((0,_.Z)(n),"changePage",(function(e,t){var a=n.state.dataSource;a.currentPage=e||1,a.pageSize=t,n.setState({dataSource:a},(function(){n.searchUserists(n.searchFormRef.current.getFieldsValue())}))})),(0,k.Z)((0,_.Z)(n),"getUserInfo",(function(e,t){(0,n.props.dispatch)({type:"userManage/getUserInfo",opt:{identifyCode:e.identifyCode},callback:function(e){var a,r=null==e||null===(a=e.data)||void 0===a?void 0:a.data;n.state.isDeatil||(r.birthday=P()(null==r?void 0:r.birthday)),n.setState({userInfo:r,isModalVisible:!0}),"edit"==t&&n.userFormRef.current.setFieldsValue(q(q({},n.state.userInfo),{},{userDesc:{remark:r.remark}},r))}})})),(0,k.Z)((0,_.Z)(n),"handleUserInfo",(function(){var e=n.props.dispatch,t=n.userFormRef.current.getFieldValue();n.userFormRef.current.validateFields().then((function(a){e({type:"userManage/modifyUserInfo",opt:q(q({},t),{},{userDesc:{remark:t.remark}}),callback:function(e){var t;200==e.data.status?(f.ZP.success("修改成功!"),n.searchUserists(n.searchFormRef.current.getFieldsValue())):f.ZP.error((null==e||null===(t=e.data)||void 0===t?void 0:t.message)||"修改失败，请重新尝试!")}}),n.handleCancel()})).catch((function(e){console.log("校验失败:",e)}))})),(0,k.Z)((0,_.Z)(n),"handleAddSubmit",(function(e){var t=n.props.dispatch;console.log("ascs",e),t({type:"userManage/saveUserInfo",opt:{username:e.username,nickName:e.nickName,phoneNumber:e.phoneNumber,emailAddress:e.emailAddress,gender:e.gender,birthday:e.birthday,sourceCode:"addByPost",userDesc:{remark:e.remark}},callback:function(e){var t;console.log(e),200==e.data.status?(f.ZP.success("添加成功!"),n.searchUserists()):f.ZP.error((null==e||null===(t=e.data)||void 0===t?void 0:t.message)||"添加失败，请重新尝试!")}}),n.handleCancel()})),(0,k.Z)((0,_.Z)(n),"handleAddVisible",(function(){n.setState({createVisible:!0})})),(0,k.Z)((0,_.Z)(n),"handleDelUserInfo",(function(){var e=n.state.userInfo;(0,n.props.dispatch)({type:"userManage/deleteUserInfo",opt:{identifyCode:e.identifyCode},callback:function(e){n.searchUserists(n.searchFormRef.current.getFieldsValue())}}),n.handleCancel()})),(0,k.Z)((0,_.Z)(n),"handleCancel",(function(){n.setState({isModalVisible:!1,delUserVisible:!1,isDeatil:!1,createVisible:!1,userInfo:{}})})),(0,k.Z)((0,_.Z)(n),"getTenantList",(function(e){(0,n.props.dispatch)({type:"userManage/getTenantList",opt:{identifyId:e.id},callback:function(e){var t,a,r=null==e||null===(t=e.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.list;r&&r.length>0&&r.map((function(e,t){e.createdTime1=n.timeShow(e.createdTime)})),n.setState({tenantList:r})}})})),(0,k.Z)((0,_.Z)(n),"timeShow",(function(e){return P()(e).utcOffset(8).format("YYYY-MM-DD HH:mm:ss")})),(0,k.Z)((0,_.Z)(n),"onClick",(function(e){var t,a,r=C.createElement(C.Fragment,null,C.createElement("br",null),C.createElement("h3",null,"租户名称:   ",e.tenantName));e.relId?p.Z.confirm({title:"请确认退出租户信息!",content:r,onOk:(a=(0,m.Z)(I().mark((function t(){return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.handleDelTenant(e);case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})}):p.Z.confirm({title:"请确认加入租户信息!",content:r,onOk:(t=(0,m.Z)(I().mark((function t(){return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.handleAddTenant(e);case 1:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})})})),(0,k.Z)((0,_.Z)(n),"handleAddTenant",(function(e){(0,n.props.dispatch)({type:"userManage/handleSaveUser",opt:{tenantId:e.id,identifyId:n.state.userInfo.id,userDesc:n.state.userInfo.userDesc,userCode:n.state.userInfo.userCode},callback:function(e){var t;200==e.data.status?(f.ZP.success("已提交申请，审核通过后即可进入新租户!"),n.getTenantList(n.state.userInfo)):f.ZP.error((null==e||null===(t=e.data)||void 0===t?void 0:t.message)||"提交申请失败，请重新尝试!")}})})),(0,k.Z)((0,_.Z)(n),"handleDelTenant",(function(e){(0,n.props.dispatch)({type:"userManage/handleDelUser",opt:{userId:e.relId},callback:function(e){var t;200==e.data.status?(f.ZP.success("删除成功!"),n.getTenantList(n.state.userInfo)):f.ZP.error((null==e||null===(t=e.data)||void 0===t?void 0:t.message)||"删除失败，请重新尝试!")}})})),n.state={isModalVisible:!1,isDeatil:!1,dataSource:{dataList:[],total:0,currentPage:1,pageSize:10},modalTitle:"",delUserVisible:!1,userInfo:{},createVisible:!1,currentDetailData:{},tenantList:[],defaultValue:[]},n}return(0,b.Z)(E,[{key:"componentDidMount",value:function(){var e=this;this.setState({tenantId:sessionStorage.getItem("tenantId")},(function(){e.searchUserists(e.searchFormRef.current.getFieldsValue())}))}},{key:"showFormModal",value:function(e,n){"edit"==n?(this.getUserInfo(e,n),this.setState({modalTitle:"编辑用户"}),this.getTenantList(e)):"detail"==n?(this.setState({isDeatil:!0,modalTitle:"查看详情"}),this.getUserInfo(e,n)):"del"==n&&this.setState({delUserVisible:!0,userInfo:e,modalTitle:"删除用户"})}},{key:"render",value:function(){var e,n=this,t=this.state,m=t.isModalVisible,f=t.tenantList,h=(t.defaultValue,t.delUserVisible),b=t.createVisible,_=t.isDeatil,g=t.dataSource,Z=t.currentDetailData,y=t.modalTitle,k=t.userInfo,x={labelCol:{xs:{span:24},sm:{span:5},md:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}},E={wrapperCol:{offset:4,span:20}},I=[{title:"序号",key:"id",textWrap:"word-break",ellipsis:!0,fixed:"left",render:function(e,n,t){return C.createElement(C.Fragment,null,C.createElement("span",null,t+1))}},{title:"账号",textWrap:"word-break",ellipsis:!0,fixed:"left",dataIndex:"username",key:"username"},{title:"姓名",textWrap:"word-break",ellipsis:!0,dataIndex:"nickName",key:"nickName"},{title:"手机号",textWrap:"word-break",ellipsis:!0,dataIndex:"phoneNumber",key:"phoneNumber"},{title:"邮箱",textWrap:"word-break",ellipsis:!0,dataIndex:"emailAddress",key:"emailAddress"},{title:"邀请码",textWrap:"word-break",ellipsis:!0,dataIndex:"sourceCode",key:"sourceCode"},{title:"操作",textWrap:"word-break",ellipsis:!0,key:"updatedTime",fixed:"right",render:function(e,t){return C.createElement(C.Fragment,null,C.createElement(u.Z,{size:"small",type:"primary",onClick:function(){return n.showFormModal(t,"detail")}},"查看"),C.createElement(u.Z,{style:{marginLeft:"10px"},size:"small",type:"primary",onClick:function(){return n.showFormModal(t,"edit")}},"编辑"),C.createElement(u.Z,{style:{marginLeft:"10px"},size:"small",type:"danger",onClick:function(){return n.showFormModal(t,"del")}},"删除"))}}];return C.createElement("div",null,C.createElement(o.Z,{className:z("searchForm"),title:"身份管理(内部)"},C.createElement(d.Z,(0,c.Z)({},x,{ref:this.searchFormRef,layout:"inline",name:"control-ref",onFinish:this.searchUserists}),C.createElement(d.Z.Item,{name:"phoneNumber",label:"手机号"},C.createElement(v.Z,null)),C.createElement(d.Z.Item,E,C.createElement(u.Z,{type:"primary",htmlType:"submit"},"查询"),C.createElement(u.Z,{htmlType:"button",style:{margin:"0 8px"},onClick:this.onReset},"清空")))),C.createElement(o.Z,{className:z("userLists")},C.createElement(u.Z,{className:z("addUserBtn"),onClick:this.handleAddVisible,type:"primary"},"新增"),C.createElement(i.Z,{scroll:{x:!0},rowKey:function(e){return e.id},dataSource:g.dataList,columns:I,pagination:!1}),C.createElement(s.Z,{style:{marginTop:"10px"},showSizeChanger:!0,scroll:{x:!0},onChange:this.changePage,defaultCurrent:g.currentPage,total:g.total})),C.createElement(p.Z,{className:z("userInfoModal"),title:y,width:800,visible:m,footer:_?null:[C.createElement(u.Z,{onClick:this.handleCancel}," 取消 "),C.createElement(u.Z,{key:"submit",type:"primary",onClick:this.handleUserInfo},"确认")],onCancel:this.handleCancel},_?C.createElement(l.Z,{column:2},C.createElement(l.Z.Item,{label:"账号"},k.username),C.createElement(l.Z.Item,{label:"姓名"},k.nickName),C.createElement(l.Z.Item,{label:"手机号"},k.phoneNumber),C.createElement(l.Z.Item,{label:"邮箱"},k.emailAddress),C.createElement(l.Z.Item,{label:"备注"},null==k||null===(e=k.userDesc)||void 0===e?void 0:e.remark)):C.createElement("div",null,C.createElement(d.Z,(0,c.Z)({},x,{ref:this.userFormRef,initialValues:k,layout:"inline",onFinish:this.onFinish}),C.createElement(d.Z.Item,{name:"username",label:"账号",rules:[{required:!0,message:"请输入账号"}]},C.createElement(v.Z,null)),C.createElement(d.Z.Item,{name:"nickName",label:"姓名",rules:[{required:!1,message:"请输入姓名"}]},C.createElement(v.Z,null)),C.createElement(d.Z.Item,{name:"sourceCode",label:"邀请码",rules:[{required:!0,message:"请输入邀请码"}]},C.createElement(v.Z,null)),C.createElement(d.Z.Item,{name:"phoneNumber",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3|4|5|6|7|8][0-9]{9}$/,message:"请输入正确手机号!"}]},C.createElement(v.Z,{placeholder:"请输入手机号"})),C.createElement(d.Z.Item,{name:"emailAddress",label:"邮箱",rules:[{type:"email",message:"这不是个正确的邮箱"},{required:!1,message:"请确认邮箱"}]},C.createElement(v.Z,{placeholder:"请输入邮箱"})),C.createElement(d.Z.Item,{name:"remark",label:"备注"},C.createElement(A,{rows:4,placeholder:"请输入备注"}))),C.createElement(r.Z,null),C.createElement("div",null,"租户列表"),C.createElement("div",{className:z("tenantList")},f.map((function(e,t){return C.createElement(o.Z,{className:z("tenantCard"),title:e.tenantName,onClick:function(){return n.onClick(e)},key:e.id},C.createElement("p",null,e.createdTime1),C.createElement("p",null,e.relId&&C.createElement(a.Z,{color:"magenta"},"已关联")))}))))),C.createElement(p.Z,{title:"删除用户",visible:h,footer:[C.createElement(u.Z,{key:"submit",type:"primary",onClick:this.handleDelUserInfo},"确认"),C.createElement(u.Z,{onClick:this.handleCancel},"取消")],onOk:this.handleDelUserInfo,onCancel:this.handleCancel},C.createElement("div",null,"即将删除",k.username,"!")),C.createElement(N,{visible:b,submitMap:this.handleAddSubmit,onCancel:this.handleCancel,currentDetailData:Z}))}}]),E}(C.Component))||T},18476:(e,n,t)=>{t.d(n,{Z:()=>l});var a=t(23645),r=t.n(a)()((function(e){return e[1]}));r.push([e.id,'html,\nbody,\ndiv,\nspan,\napplet,\nobject,\niframe,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\np,\nblockquote,\npre,\na,\nabbr,\nacronym,\naddress,\nbig,\ncite,\ncode,\ndel,\ndfn,\nem,\nimg,\nins,\nkbd,\nq,\ns,\nsamp,\nsmall,\nstrike,\nstrong,\nsub,\nsup,\ntt,\nvar,\nb,\nu,\ni,\ncenter,\ndl,\ndt,\ndd,\nol,\nul,\nli,\nfieldset,\nform,\nlabel,\nlegend,\ntable,\ncaption,\ntbody,\ntfoot,\nthead,\ntr,\nth,\ntd,\narticle,\naside,\ncanvas,\ndetails,\nembed,\nfigure,\nfigcaption,\nfooter,\nheader,\nhgroup,\nmenu,\nnav,\noutput,\nruby,\nsection,\nsummary,\ntime,\nmark,\naudio,\nvideo {\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-size: 100%;\n  font: inherit;\n  vertical-align: baseline;\n  font-family: "微软雅黑", "Arial", "华文细黑", "STHeiti", "MingLiu";\n}\n/* HTML5 display-role reset for older browsers */\narticle,\naside,\ndetails,\nfigcaption,\nfigure,\nfooter,\nheader,\nhgroup,\nmenu,\nnav,\nsection {\n  display: block;\n}\nbody {\n  line-height: 1;\n}\nol,\nul {\n  list-style: none;\n}\nblockquote,\nq {\n  quotes: none;\n}\nblockquote:before,\nblockquote:after,\nq:before,\nq:after {\n  content: \'\';\n  content: none;\n}\ntable {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\na {\n  color: #000;\n  text-decoration: none;\n}\na:hover {\n  color: #000;\n  text-decoration: none;\n}\n::-webkit-scrollbar-track {\n  background-color: transparent;\n}\n::-webkit-scrollbar {\n  width: 10px;\n  height: 10px;\n}\n::-webkit-scrollbar-thumb {\n  background-color: #aaa;\n  border-radius: 10px;\n}\n#index-module__root___3f3-P {\n  height: 100%;\n}\n.index-module__box___VD6sl {\n  width: 100%;\n  display: flex;\n  height: 100%;\n  min-height: 92vh;\n  background-color: #f0f2f5;\n}\n.index-module__userManage___35KoV .ant-card {\n  margin: 20px;\n  border-radius: 7px;\n  border-color: transparent;\n  box-shadow: 0 1px 2px -2px #00000029, 0 3px 6px #0000001f, 0 5px 12px 4px #00000017;\n}\n.index-module__userManage___35KoV .index-module__userLists___2sczl .index-module__addUserBtn___OYWbg {\n  float: right;\n  margin-bottom: 20px;\n}\n.index-module__userManage___35KoV .index-module__userInfoModal___12p0b {\n  width: 100%;\n}\n.index-module__userManage___35KoV .index-module__tenantList___2fW7F {\n  display: flex;\n  flex-wrap: wrap;\n}\n.index-module__userManage___35KoV .index-module__tenantList___2fW7F .index-module__tenantCard___1Mv0O {\n  max-width: 30%;\n}\n.index-module__searchForm___aH34s .ant-form-inline .ant-form-item {\n  width: 260px;\n}\n.index-module__userInfoModal___12p0b .ant-form-item {\n  width: 100%;\n  margin-bottom: 10px;\n}\n.index-module__userInfoModal___12p0b .ant-form-item .ant-form-item-label {\n  width: 100px;\n}\n',""]),r.locals={root:"index-module__root___3f3-P",box:"index-module__box___VD6sl",userManage:"index-module__userManage___35KoV",userLists:"index-module__userLists___2sczl",addUserBtn:"index-module__addUserBtn___OYWbg",userInfoModal:"index-module__userInfoModal___12p0b",tenantList:"index-module__tenantList___2fW7F",tenantCard:"index-module__tenantCard___1Mv0O",searchForm:"index-module__searchForm___aH34s"};const l=r}}]);